

1.把图编码成一维向量

不可行：原子的个数不定，升维无法设计

2.隐变量在双曲空间 缩放，加噪声在隐空间





噪声采样自$N(0,\Sigma)$

平行传输至$\mu$，exp



VAE

双曲kl 参考RoWN



优化HDM

$sample\ t\sim u(0,...,T) ,\epsilon \sim  N(0,I)$

$z_x = \alpha_tx+\sigma_t \epsilon_x$

$scale\_h=exp(\alpha_tlog(h))$

$z_h=exp_{scale\_h}(PT_{scale\_h}(\sigma_t \epsilon_h))$

$z_t=[z_x,z_h]$

$min||\epsilon-\phi(z_t,t)||^2$



Sampling from HDM

$sample\ z_T \sim  N(0,I)$

$z_{T_x}=z_{x_T}$

$z_{T_h}=exp(z_{T_h})$

$z_t=[z_x,z_h]$

$for\ t = T,...,1$

$\longrightarrow  sample\ \epsilon \sim  N(0,I)$

$\longrightarrow  denoise=-\frac{\sigma^2_{t|s}}{\alpha_{t|s}\sigma_t}\phi(z_t,t)$

$\longrightarrow  scale\_h=exp(1/\alpha_{t|s}log(z_{t_h}))$

$\longrightarrow z_{s_x}:original\ method$

$\longrightarrow bias=denoise+\sigma_{t\rarr s}\epsilon$

$\longrightarrow z_{s_h}=exp_{scale\_h}(PT_{scale\_h}(bias))$

$\longrightarrow z_s=[z_{s_x},z_{s_h}]$



送入dynamic的是manifold上的，在dynamic log加上t​
$$
\begin{align}
&\epsilon_{{t-1}_{hyp}}=Exp_o(\sqrt{1-{\alpha}_{t}}\epsilon_{t-1})\\
&x_{t}=Log_o(Exp_{\epsilon_{{t-1}_{hyp}}}(PT_{o\rarr \epsilon_{{t-1}_{hyp}}}(\sqrt{{\alpha}_{t}}x_{t-1})))\\
&x_{t}=Func_{\epsilon_{{t-1}_{hyp}}}(\sqrt{{\alpha}_{t}}x_{t-1})≠Func_{\epsilon_{hyp}}(\sqrt{\bar{\alpha}_{t}} \mathbf{x}_{0})
\end{align}
$$

$$
\begin{align}

&x_{t}=\sqrt{{\alpha}_{t}}\otimes_cx_{t-1}\oplus_c \sqrt{1-{\alpha}_{t}}\otimes_c Exp_o(\epsilon_{t-1})\\
&x_{t}=\sqrt{{\alpha}_{t}}\otimes_c (\sqrt{{\alpha}_{t-1}}x_{t-2}\oplus_c \sqrt{1-{\alpha}_{t-1}}\otimes_c Exp_o(\epsilon_{t-2}))\oplus_c \sqrt{1-{\alpha}_{t}}\otimes_c Exp_o(\epsilon_{t-1})\\
&x_{t}≠\sqrt{{\alpha}_{t}}\otimes_c \sqrt{{\alpha}_{t-1}}x_{t-2}\oplus_c (\sqrt{{\alpha}_{t}} \otimes_c \sqrt{1-{\alpha}_{t-1}}\otimes_c Exp_o(\epsilon_{t-2})\oplus_c \sqrt{1-{\alpha}_{t}}\otimes_c Exp_o(\epsilon_{t-1}))
\end{align}
$$

